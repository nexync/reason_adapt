Running task ID: 0, iterating from 0 to 20
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.39s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.42s/it]
Using cuda
Save path of ./out/chess/all_r16_a8/run1/res_0_20.pkl
Generating train split:   0%|          | 0/5037439 [00:00<?, ? examples/s]Generating train split:   2%|▏         | 125000/5037439 [00:00<00:04, 1217111.92 examples/s]Generating train split:   6%|▌         | 282000/5037439 [00:00<00:03, 1415295.58 examples/s]Generating train split:   9%|▉         | 447000/5037439 [00:00<00:03, 1519927.39 examples/s]Generating train split:  12%|█▏        | 604000/5037439 [00:00<00:02, 1535727.73 examples/s]Generating train split:  15%|█▌        | 771000/5037439 [00:00<00:02, 1582816.95 examples/s]Generating train split:  20%|█▉        | 1007000/5037439 [00:00<00:02, 1576490.42 examples/s]Generating train split:  23%|██▎       | 1172000/5037439 [00:00<00:02, 1594674.90 examples/s]Generating train split:  27%|██▋       | 1339000/5037439 [00:00<00:02, 1611338.33 examples/s]Generating train split:  30%|██▉       | 1505000/5037439 [00:00<00:02, 1623161.50 examples/s]Generating train split:  33%|███▎      | 1672000/5037439 [00:01<00:02, 1634634.50 examples/s]Generating train split:  37%|███▋      | 1881147/5037439 [00:01<00:02, 1537029.18 examples/s]Generating train split:  40%|████      | 2037147/5037439 [00:01<00:01, 1539798.44 examples/s]Generating train split:  44%|████▎     | 2194147/5037439 [00:01<00:01, 1545626.36 examples/s]Generating train split:  47%|████▋     | 2359147/5037439 [00:01<00:01, 1572401.56 examples/s]Generating train split:  51%|█████     | 2547147/5037439 [00:01<00:01, 1440181.23 examples/s]Generating train split:  54%|█████▍    | 2712147/5037439 [00:01<00:01, 1492876.72 examples/s]Generating train split:  57%|█████▋    | 2874147/5037439 [00:01<00:01, 1520139.81 examples/s]Generating train split:  60%|██████    | 3037147/5037439 [00:01<00:01, 1547518.63 examples/s]Generating train split:  64%|██████▎   | 3199147/5037439 [00:02<00:01, 1564934.65 examples/s]Generating train split:  67%|██████▋   | 3359293/5037439 [00:02<00:01, 1500651.27 examples/s]Generating train split:  70%|██████▉   | 3517293/5037439 [00:02<00:00, 1521476.98 examples/s]Generating train split:  73%|███████▎  | 3676293/5037439 [00:02<00:00, 1539482.95 examples/s]Generating train split:  76%|███████▌  | 3834293/5037439 [00:02<00:00, 1548327.27 examples/s]Generating train split:  79%|███████▉  | 3998293/5037439 [00:02<00:00, 1571886.29 examples/s]Generating train split:  83%|████████▎ | 4156293/5037439 [00:02<00:00, 1571194.75 examples/s]Generating train split:  86%|████████▌ | 4319293/5037439 [00:02<00:00, 1586146.08 examples/s]Generating train split:  89%|████████▉ | 4479293/5037439 [00:02<00:00, 1587808.52 examples/s]Generating train split:  92%|█████████▏| 4639293/5037439 [00:02<00:00, 1588286.98 examples/s]Generating train split:  95%|█████████▌| 4802293/5037439 [00:03<00:00, 1599707.83 examples/s]Generating train split:  99%|█████████▉| 4999293/5037439 [00:03<00:00, 1423216.78 examples/s]Generating train split: 100%|██████████| 5037439/5037439 [00:03<00:00, 1531851.73 examples/s]
Traceback (most recent call last):
  File "/weka/scratch/bvandur1/jeffc/adapt_reason/infer.py", line 241, in <module>
    main()
  File "/weka/scratch/bvandur1/jeffc/adapt_reason/infer.py", line 194, in main
    model_prompt += explain_fen(item["FEN"], item["Moves"].split(" ")[0])
  File "/weka/scratch/bvandur1/jeffc/adapt_reason/utils/infer_utils.py", line 252, in explain_fen
    s += f", taking the {epiece[0]} {epiece[1]} on {end}."
TypeError: 'NoneType' object is not subscriptable
